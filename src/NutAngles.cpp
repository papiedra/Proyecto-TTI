#include "..\include\NutAngles.hpp"

std::tuple<double, double> NutAngles(double Mjd_TT) {

    double T  = (Mjd_TT-MJD_J2000)/36525;
    double T2 = T*T;
    double T3 = T2*T;
    double rev = 360*3600; 

    int N_coeff = 106;

    Matrix C = zeros(N_coeff, 9);


    C(1,1)=0; C(1,2)=0; C(1,3)=0; C(1,4)=0; C(1,5)=1; C(1,6)=-1719960; C(1,7)=-1742; C(1,8)=920250; C(1,9)=89;
C(2,1)=0; C(2,2)=0; C(2,3)=0; C(2,4)=0; C(2,5)=2; C(2,6)=20620; C(2,7)=2; C(2,8)=-8950; C(2,9)=5;
C(3,1)=-2; C(3,2)=0; C(3,3)=2; C(3,4)=0; C(3,5)=1; C(3,6)=460; C(3,7)=0; C(3,8)=-240; C(3,9)=0;
C(4,1)=2; C(4,2)=0; C(4,3)=-2; C(4,4)=0; C(4,5)=0; C(4,6)=110; C(4,7)=0; C(4,8)=0; C(4,9)=0;
C(5,1)=-2; C(5,2)=0; C(5,3)=2; C(5,4)=0; C(5,5)=2; C(5,6)=-30; C(5,7)=0; C(5,8)=10; C(5,9)=0;
C(6,1)=1; C(6,2)=-1; C(6,3)=0; C(6,4)=-1; C(6,5)=0; C(6,6)=-30; C(6,7)=0; C(6,8)=0; C(6,9)=0;
C(7,1)=0; C(7,2)=-2; C(7,3)=2; C(7,4)=-2; C(7,5)=1; C(7,6)=-20; C(7,7)=0; C(7,8)=10; C(7,9)=0;
C(8,1)=2; C(8,2)=0; C(8,3)=-2; C(8,4)=0; C(8,5)=1; C(8,6)=10; C(8,7)=0; C(8,8)=0; C(8,9)=0;
C(9,1)=0; C(9,2)=0; C(9,3)=2; C(9,4)=-2; C(9,5)=2; C(9,6)=-131870; C(9,7)=-16; C(9,8)=57360; C(9,9)=-31;
C(10,1)=0; C(10,2)=1; C(10,3)=0; C(10,4)=0; C(10,5)=0; C(10,6)=14260; C(10,7)=-34; C(10,8)=540; C(10,9)=-1;
C(11,1)=0; C(11,2)=1; C(11,3)=2; C(11,4)=-2; C(11,5)=2; C(11,6)=-5170; C(11,7)=12; C(11,8)=2240; C(11,9)=-6;
C(12,1)=0; C(12,2)=-1; C(12,3)=2; C(12,4)=-2; C(12,5)=2; C(12,6)=2170; C(12,7)=-5; C(12,8)=-950; C(12,9)=3;
C(13,1)=0; C(13,2)=0; C(13,3)=2; C(13,4)=-2; C(13,5)=1; C(13,6)=1290; C(13,7)=1; C(13,8)=-700; C(13,9)=0;
C(14,1)=2; C(14,2)=0; C(14,3)=0; C(14,4)=-2; C(14,5)=0; C(14,6)=480; C(14,7)=0; C(14,8)=10; C(14,9)=0;
C(15,1)=0; C(15,2)=0; C(15,3)=2; C(15,4)=-2; C(15,5)=0; C(15,6)=-220; C(15,7)=0; C(15,8)=0; C(15,9)=0;
C(16,1)=0; C(16,2)=2; C(16,3)=0; C(16,4)=0; C(16,5)=0; C(16,6)=170; C(16,7)=-1; C(16,8)=0; C(16,9)=0;
C(17,1)=0; C(17,2)=1; C(17,3)=0; C(17,4)=0; C(17,5)=1; C(17,6)=-150; C(17,7)=0; C(17,8)=90; C(17,9)=0;
C(18,1)=0; C(18,2)=2; C(18,3)=2; C(18,4)=-2; C(18,5)=2; C(18,6)=-160; C(18,7)=1; C(18,8)=70; C(18,9)=0;
C(19,1)=0; C(19,2)=-1; C(19,3)=0; C(19,4)=0; C(19,5)=1; C(19,6)=-120; C(19,7)=0; C(19,8)=60; C(19,9)=0;
C(20,1)=-2; C(20,2)=0; C(20,3)=0; C(20,4)=2; C(20,5)=1; C(20,6)=-60; C(20,7)=0; C(20,8)=30; C(20,9)=0;
C(21,1)=0; C(21,2)=-1; C(21,3)=2; C(21,4)=-2; C(21,5)=1; C(21,6)=-50; C(21,7)=0; C(21,8)=30; C(21,9)=0;
C(22,1)=2; C(22,2)=0; C(22,3)=0; C(22,4)=-2; C(22,5)=1; C(22,6)=40; C(22,7)=0; C(22,8)=-20; C(22,9)=0;
C(23,1)=0; C(23,2)=1; C(23,3)=2; C(23,4)=-2; C(23,5)=1; C(23,6)=40; C(23,7)=0; C(23,8)=-20; C(23,9)=0;
C(24,1)=1; C(24,2)=0; C(24,3)=0; C(24,4)=-1; C(24,5)=0; C(24,6)=-40; C(24,7)=0; C(24,8)=0; C(24,9)=0;
C(25,1)=2; C(25,2)=1; C(25,3)=0; C(25,4)=-2; C(25,5)=0; C(25,6)=10; C(25,7)=0; C(25,8)=0; C(25,9)=0;
C(26,1)=0; C(26,2)=0; C(26,3)=-2; C(26,4)=2; C(26,5)=1; C(26,6)=10; C(26,7)=0; C(26,8)=0; C(26,9)=0;
C(27,1)=0; C(27,2)=1; C(27,3)=-2; C(27,4)=2; C(27,5)=0; C(27,6)=-10; C(27,7)=0; C(27,8)=0; C(27,9)=0;
C(28,1)=0; C(28,2)=1; C(28,3)=0; C(28,4)=0; C(28,5)=2; C(28,6)=10; C(28,7)=0; C(28,8)=0; C(28,9)=0;
C(29,1)=-1; C(29,2)=0; C(29,3)=0; C(29,4)=1; C(29,5)=1; C(29,6)=10; C(29,7)=0; C(29,8)=0; C(29,9)=0;
C(30,1)=0; C(30,2)=1; C(30,3)=2; C(30,4)=-2; C(30,5)=0; C(30,6)=-10; C(30,7)=0; C(30,8)=0; C(30,9)=0;
C(31,1)=0; C(31,2)=0; C(31,3)=2; C(31,4)=0; C(31,5)=2; C(31,6)=-22740; C(31,7)=-2; C(31,8)=9770; C(31,9)=-5;
C(32,1)=1; C(32,2)=0; C(32,3)=0; C(32,4)=0; C(32,5)=0; C(32,6)=7120; C(32,7)=1; C(32,8)=-70; C(32,9)=0;
C(33,1)=0; C(33,2)=0; C(33,3)=2; C(33,4)=0; C(33,5)=1; C(33,6)=-3860; C(33,7)=-4; C(33,8)=2000; C(33,9)=0;
C(34,1)=1; C(34,2)=0; C(34,3)=2; C(34,4)=0; C(34,5)=2; C(34,6)=-3010; C(34,7)=0; C(34,8)=1290; C(34,9)=-1;
C(35,1)=1; C(35,2)=0; C(35,3)=0; C(35,4)=-2; C(35,5)=0; C(35,6)=-1580; C(35,7)=0; C(35,8)=-10; C(35,9)=0;
C(36,1)=-1; C(36,2)=0; C(36,3)=2; C(36,4)=0; C(36,5)=2; C(36,6)=1230; C(36,7)=0; C(36,8)=-530; C(36,9)=0;
C(37,1)=0; C(37,2)=0; C(37,3)=0; C(37,4)=2; C(37,5)=0; C(37,6)=630; C(37,7)=0; C(37,8)=-20; C(37,9)=0;
C(38,1)=1; C(38,2)=0; C(38,3)=0; C(38,4)=0; C(38,5)=1; C(38,6)=630; C(38,7)=1; C(38,8)=-330; C(38,9)=0;
C(39,1)=-1; C(39,2)=0; C(39,3)=0; C(39,4)=0; C(39,5)=1; C(39,6)=-580; C(39,7)=-1; C(39,8)=320; C(39,9)=0;
C(40,1)=-1; C(40,2)=0; C(40,3)=2; C(40,4)=2; C(40,5)=2; C(40,6)=-590; C(40,7)=0; C(40,8)=260; C(40,9)=0;
C(41,1)=1; C(41,2)=0; C(41,3)=2; C(41,4)=0; C(41,5)=1; C(41,6)=-510; C(41,7)=0; C(41,8)=270; C(41,9)=0;
C(42,1)=0; C(42,2)=0; C(42,3)=2; C(42,4)=2; C(42,5)=2; C(42,6)=-380; C(42,7)=0; C(42,8)=160; C(42,9)=0;
C(43,1)=2; C(43,2)=0; C(43,3)=0; C(43,4)=0; C(43,5)=0; C(43,6)=290; C(43,7)=0; C(43,8)=-10; C(43,9)=0;
C(44,1)=1; C(44,2)=0; C(44,3)=2; C(44,4)=-2; C(44,5)=2; C(44,6)=290; C(44,7)=0; C(44,8)=-120; C(44,9)=0;
C(45,1)=2; C(45,2)=0; C(45,3)=2; C(45,4)=0; C(45,5)=2; C(45,6)=-310; C(45,7)=0; C(45,8)=130; C(45,9)=0;
C(46,1)=0; C(46,2)=0; C(46,3)=2; C(46,4)=0; C(46,5)=0; C(46,6)=260; C(46,7)=0; C(46,8)=-10; C(46,9)=0;
C(47,1)=-1; C(47,2)=0; C(47,3)=2; C(47,4)=0; C(47,5)=1; C(47,6)=210; C(47,7)=0; C(47,8)=-100; C(47,9)=0;
C(48,1)=-1; C(48,2)=0; C(48,3)=0; C(48,4)=2; C(48,5)=1; C(48,6)=160; C(48,7)=0; C(48,8)=-80; C(48,9)=0;
C(49,1)=1; C(49,2)=0; C(49,3)=0; C(49,4)=-2; C(49,5)=1; C(49,6)=-130; C(49,7)=0; C(49,8)=70; C(49,9)=0;
C(50,1)=-1; C(50,2)=0; C(50,3)=2; C(50,4)=2; C(50,5)=1; C(50,6)=-100; C(50,7)=0; C(50,8)=50; C(50,9)=0;
C(51,1)=1; C(51,2)=1; C(51,3)=0; C(51,4)=-2; C(51,5)=0; C(51,6)=-70; C(51,7)=0; C(51,8)=0; C(51,9)=0;
C(52,1)=0; C(52,2)=1; C(52,3)=2; C(52,4)=0; C(52,5)=2; C(52,6)=70; C(52,7)=0; C(52,8)=-30; C(52,9)=0;
C(53,1)=0; C(53,2)=-1; C(53,3)=2; C(53,4)=0; C(53,5)=2; C(53,6)=-70; C(53,7)=0; C(53,8)=30; C(53,9)=0;
C(54,1)=1; C(54,2)=0; C(54,3)=2; C(54,4)=2; C(54,5)=2; C(54,6)=-80; C(54,7)=0; C(54,8)=30; C(54,9)=0;
C(55,1)=1; C(55,2)=0; C(55,3)=0; C(55,4)=2; C(55,5)=0; C(55,6)=60; C(55,7)=0; C(55,8)=0; C(55,9)=0;
C(56,1)=2; C(56,2)=0; C(56,3)=2; C(56,4)=-2; C(56,5)=2; C(56,6)=60; C(56,7)=0; C(56,8)=-30; C(56,9)=0;
C(57,1)=0; C(57,2)=0; C(57,3)=0; C(57,4)=2; C(57,5)=1; C(57,6)=-60; C(57,7)=0; C(57,8)=30; C(57,9)=0;
C(58,1)=0; C(58,2)=0; C(58,3)=2; C(58,4)=2; C(58,5)=1; C(58,6)=-70; C(58,7)=0; C(58,8)=30; C(58,9)=0;
C(59,1)=1; C(59,2)=0; C(59,3)=2; C(59,4)=-2; C(59,5)=1; C(59,6)=60; C(59,7)=0; C(59,8)=-30; C(59,9)=0;
C(60,1)=0; C(60,2)=0; C(60,3)=0; C(60,4)=-2; C(60,5)=1; C(60,6)=-50; C(60,7)=0; C(60,8)=30; C(60,9)=0;
C(61,1)=1; C(61,2)=-1; C(61,3)=0; C(61,4)=0; C(61,5)=0; C(61,6)=50; C(61,7)=0; C(61,8)=0; C(61,9)=0;
C(62,1)=2; C(62,2)=0; C(62,3)=2; C(62,4)=0; C(62,5)=1; C(62,6)=-50; C(62,7)=0; C(62,8)=30; C(62,9)=0;
C(63,1)=0; C(63,2)=1; C(63,3)=0; C(63,4)=-2; C(63,5)=0; C(63,6)=-40; C(63,7)=0; C(63,8)=0; C(63,9)=0;
C(64,1)=1; C(64,2)=0; C(64,3)=-2; C(64,4)=0; C(64,5)=0; C(64,6)=40; C(64,7)=0; C(64,8)=0; C(64,9)=0;
C(65,1)=0; C(65,2)=0; C(65,3)=0; C(65,4)=1; C(65,5)=0; C(65,6)=-40; C(65,7)=0; C(65,8)=0; C(65,9)=0;
C(66,1)=1; C(66,2)=1; C(66,3)=0; C(66,4)=0; C(66,5)=0; C(66,6)=-30; C(66,7)=0; C(66,8)=0; C(66,9)=0;
C(67,1)=1; C(67,2)=0; C(67,3)=2; C(67,4)=0; C(67,5)=0; C(67,6)=30; C(67,7)=0; C(67,8)=0; C(67,9)=0;
C(68,1)=1; C(68,2)=-1; C(68,3)=2; C(68,4)=0; C(68,5)=2; C(68,6)=-30; C(68,7)=0; C(68,8)=10; C(68,9)=0;
C(69,1)=-1; C(69,2)=-1; C(69,3)=2; C(69,4)=2; C(69,5)=2; C(69,6)=-30; C(69,7)=0; C(69,8)=10; C(69,9)=0;
C(70,1)=-2; C(70,2)=0; C(70,3)=0; C(70,4)=0; C(70,5)=1; C(70,6)=-20; C(70,7)=0; C(70,8)=10; C(70,9)=0;
C(71,1)=3; C(71,2)=0; C(71,3)=2; C(71,4)=0; C(71,5)=2; C(71,6)=-30; C(71,7)=0; C(71,8)=10; C(71,9)=0;
C(72,1)=0; C(72,2)=-1; C(72,3)=2; C(72,4)=2; C(72,5)=2; C(72,6)=-30; C(72,7)=0; C(72,8)=10; C(72,9)=0;
C(73,1)=1; C(73,2)=1; C(73,3)=2; C(73,4)=0; C(73,5)=2; C(73,6)=20; C(73,7)=0; C(73,8)=-10; C(73,9)=0;
C(74,1)=-1; C(74,2)=0; C(74,3)=2; C(74,4)=-2; C(74,5)=1; C(74,6)=-20; C(74,7)=0; C(74,8)=10; C(74,9)=0;
C(75,1)=2; C(75,2)=0; C(75,3)=0; C(75,4)=0; C(75,5)=1; C(75,6)=20; C(75,7)=0; C(75,8)=-10; C(75,9)=0;
C(76,1)=1; C(76,2)=0; C(76,3)=0; C(76,4)=0; C(76,5)=2; C(76,6)=-20; C(76,7)=0; C(76,8)=10; C(76,9)=0;
C(77,1)=3; C(77,2)=0; C(77,3)=0; C(77,4)=0; C(77,5)=0; C(77,6)=20; C(77,7)=0; C(77,8)=0; C(77,9)=0;
C(78,1)=0; C(78,2)=0; C(78,3)=2; C(78,4)=1; C(78,5)=2; C(78,6)=20; C(78,7)=0; C(78,8)=-10; C(78,9)=0;
C(79,1)=-1; C(79,2)=0; C(79,3)=0; C(79,4)=0; C(79,5)=2; C(79,6)=10; C(79,7)=0; C(79,8)=-10; C(79,9)=0;
C(80,1)=1; C(80,2)=0; C(80,3)=0; C(80,4)=-4; C(80,5)=0; C(80,6)=-10; C(80,7)=0; C(80,8)=0; C(80,9)=0;
C(81,1)=-2; C(81,2)=0; C(81,3)=2; C(81,4)=2; C(81,5)=2; C(81,6)=10; C(81,7)=0; C(81,8)=-10; C(81,9)=0;
C(82,1)=-1; C(82,2)=0; C(82,3)=2; C(82,4)=4; C(82,5)=2; C(82,6)=-20; C(82,7)=0; C(82,8)=10; C(82,9)=0;
C(83,1)=2; C(83,2)=0; C(83,3)=0; C(83,4)=-4; C(83,5)=0; C(83,6)=-10; C(83,7)=0; C(83,8)=0; C(83,9)=0;
C(84,1)=1; C(84,2)=1; C(84,3)=2; C(84,4)=-2; C(84,5)=2; C(84,6)=10; C(84,7)=0; C(84,8)=-10; C(84,9)=0;
C(85,1)=1; C(85,2)=0; C(85,3)=2; C(85,4)=2; C(85,5)=1; C(85,6)=-10; C(85,7)=0; C(85,8)=10; C(85,9)=0;
C(86,1)=-2; C(86,2)=0; C(86,3)=2; C(86,4)=4; C(86,5)=2; C(86,6)=-10; C(86,7)=0; C(86,8)=10; C(86,9)=0;
C(87,1)=-1; C(87,2)=0; C(87,3)=4; C(87,4)=0; C(87,5)=2; C(87,6)=10; C(87,7)=0; C(87,8)=0; C(87,9)=0;
C(88,1)=1; C(88,2)=-1; C(88,3)=0; C(88,4)=-2; C(88,5)=0; C(88,6)=10; C(88,7)=0; C(88,8)=0; C(88,9)=0;
C(89,1)=2; C(89,2)=0; C(89,3)=2; C(89,4)=-2; C(89,5)=1; C(89,6)=10; C(89,7)=0; C(89,8)=-10; C(89,9)=0;
C(90,1)=2; C(90,2)=0; C(90,3)=2; C(90,4)=2; C(90,5)=2; C(90,6)=-10; C(90,7)=0; C(90,8)=0; C(90,9)=0;
C(91,1)=1; C(91,2)=0; C(91,3)=0; C(91,4)=2; C(91,5)=1; C(91,6)=-10; C(91,7)=0; C(91,8)=0; C(91,9)=0;
C(92,1)=0; C(92,2)=0; C(92,3)=4; C(92,4)=-2; C(92,5)=2; C(92,6)=10; C(92,7)=0; C(92,8)=0; C(92,9)=0;
C(93,1)=3; C(93,2)=0; C(93,3)=2; C(93,4)=-2; C(93,5)=2; C(93,6)=10; C(93,7)=0; C(93,8)=0; C(93,9)=0;
C(94,1)=1; C(94,2)=0; C(94,3)=2; C(94,4)=-2; C(94,5)=0; C(94,6)=-10; C(94,7)=0; C(94,8)=0; C(94,9)=0;
C(95,1)=0; C(95,2)=1; C(95,3)=2; C(95,4)=0; C(95,5)=1; C(95,6)=10; C(95,7)=0; C(95,8)=0; C(95,9)=0;
C(96,1)=-1; C(96,2)=-1; C(96,3)=0; C(96,4)=2; C(96,5)=1; C(96,6)=10; C(96,7)=0; C(96,8)=0; C(96,9)=0;
C(97,1)=0; C(97,2)=0; C(97,3)=-2; C(97,4)=0; C(97,5)=1; C(97,6)=-10; C(97,7)=0; C(97,8)=0; C(97,9)=0;
C(98,1)=0; C(98,2)=0; C(98,3)=2; C(98,4)=-1; C(98,5)=2; C(98,6)=-10; C(98,7)=0; C(98,8)=0; C(98,9)=0;
C(99,1)=0; C(99,2)=1; C(99,3)=0; C(99,4)=2; C(99,5)=0; C(99,6)=-10; C(99,7)=0; C(99,8)=0; C(99,9)=0;
C(100,1)=1; C(100,2)=0; C(100,3)=-2; C(100,4)=-2; C(100,5)=0; C(100,6)=-10; C(100,7)=0; C(100,8)=0; C(100,9)=0;
C(101,1)=0; C(101,2)=-1; C(101,3)=2; C(101,4)=0; C(101,5)=1; C(101,6)=-10; C(101,7)=0; C(101,8)=0; C(101,9)=0;
C(102,1)=1; C(102,2)=1; C(102,3)=0; C(102,4)=-2; C(102,5)=1; C(102,6)=-10; C(102,7)=0; C(102,8)=0; C(102,9)=0;
C(103,1)=1; C(103,2)=0; C(103,3)=-2; C(103,4)=2; C(103,5)=0; C(103,6)=-10; C(103,7)=0; C(103,8)=0; C(103,9)=0;
C(104,1)=2; C(104,2)=0; C(104,3)=0; C(104,4)=2; C(104,5)=0; C(104,6)=10; C(104,7)=0; C(104,8)=0; C(104,9)=0;
C(105,1)=0; C(105,2)=0; C(105,3)=2; C(105,4)=4; C(105,5)=2; C(105,6)=-10; C(105,7)=0; C(105,8)=0; C(105,9)=0;
C(106,1)=0; C(106,2)=1; C(106,3)=0; C(106,4)=1; C(106,5)=1; C(106,6)=10; C(106,7)=0; C(106,8)=0; C(106,9)=0;


    double l  = fmod(485866.733 + (1325.0*rev +  715922.633)*T + 31.310*T2 + 0.064*T3, rev );
    double lp = fmod ( 1287099.804 + (  99.0*rev + 1292581.224)*T
                                -  0.577*T2 - 0.012*T3, rev );
    double F  = fmod (  335778.877 + (1342.0*rev +  295263.137)*T
                                - 13.257*T2 + 0.011*T3, rev );
    double D  = fmod ( 1072261.307 + (1236.0*rev + 1105601.328)*T
                                -  6.891*T2 + 0.019*T3, rev );
    double Om = fmod (  450160.280 - (   5.0*rev +  482890.539)*T
                                +  7.455*T2 + 0.008*T3, rev );


    double dpsi = 0;
    double deps = 0;

    for (int i=1; i<=N_coeff; i++) {
        double arg  =  ( C(i,1)*l+C(i,2)*lp+C(i,3)*F+C(i,4)*D+C(i,5)*Om )/Arcs;
        dpsi = dpsi + ( C(i,6)+C(i,7)*T ) * sin(arg);
    deps = deps + ( C(i,8)+C(i,9)*T ) * cos(arg);
    }

    dpsi = 1.0e-5 * dpsi/Arcs;
    deps = 1.0e-5 * deps/Arcs;

    return std::make_tuple(dpsi, deps);
}